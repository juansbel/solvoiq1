import{r as h,u as we,h as ye,i as A,j as e,k as o,I as m,S as Me,C as x,c as j,U as E,G as Ce,n as q,l as Te,a as Se,b as ke,m as Le,L as O,E as $,M as V,F as z,K,B as M,P as _,p as De,q as G,s as Q}from"./index-Dsch-6rs.js";import{u as U}from"./useMutation-CWIftKBJ.js";import{u as Ae,F as Ee,a as u,b as p,c as g,d as f,t as Pe,e as Fe}from"./schema-DufpuSdc.js";import{u as Re}from"./use-debounce-DnMWKfEB.js";import{C as B}from"./character-avatar-CLvC-lt9.js";import{G as We,D as Y,a as H,E as J,b as X,c as Ie,d as i,e as Z}from"./dropdown-menu-Cu0s_O6A.js";import{S as qe,a as Oe,b as $e,c as Ve,d as ee}from"./select-DXDaqklB.js";import{D as ze,a as Ke,b as _e,c as Ge,d as Qe,e as Ue,f as Be}from"./dialog-DSRUCjP6.js";import{P as se}from"./plus-CRp7_VfK.js";import{L as Ye}from"./list-Drvxxyga.js";import{T as ae}from"./trophy-DfUzTZ2i.js";import{S as le}from"./square-pen-BNtb5a4z.js";import{M as te}from"./map-pin-Du8NuVPX.js";import"./Combination-Cg6MJVDY.js";import"./index-CJCVC222.js";import"./index-8CgwoEGl.js";function hs(){const[C,re]=h.useState(""),v=Re(C,300),[b,ne]=h.useState("all"),[w,P]=h.useState("grid"),[ie,T]=h.useState(!1),{toast:S}=we(),F=ye();h.useEffect(()=>{document.title="Team - ClientHub AI"},[]);const c=Ae({resolver:Pe(Fe),defaultValues:{userId:"1",name:"",email:"",role:"",position:"",location:"",teamMemberId:"",skills:[],incapacidades:[],oneOnOneSessions:[]}}),{data:d=[],isLoading:ce,error:He}=A({queryKey:["/api/team-members"],staleTime:3e4}),{data:de=[]}=A({queryKey:["/api/tasks"],staleTime:3e4}),{data:oe=[]}=A({queryKey:["/api/clients"],staleTime:3e4}),R=h.useMemo(()=>d.filter(s=>{const a=s.name.toLowerCase().includes(v.toLowerCase())||s.email.toLowerCase().includes(v.toLowerCase())||s.role.toLowerCase().includes(v.toLowerCase());return b==="all"?a:a&&s.role.toLowerCase()===b.toLowerCase()}),[d,v,b]),k=U({mutationFn:async s=>(await Q("POST","/api/team-members",s)).json(),onSuccess:()=>{F.invalidateQueries({queryKey:["/api/team-members"]}),c.reset(),T(!1),S({title:"Team member added",description:"Team member has been successfully created."})},onError:s=>{console.error("Team member creation error:",s),S({title:"Error",description:(s==null?void 0:s.message)||"Failed to add team member",variant:"destructive"})}}),W=U({mutationFn:s=>Q("DELETE",`/api/team-members/${s}`),onSuccess:()=>{F.invalidateQueries({queryKey:["/api/team-members"]}),S({title:"Team member removed",description:"Team member has been successfully removed."})}}),me=s=>{k.mutate(s)},N=s=>{const a=de.filter(t=>t.assignedTo&&t.assignedTo.includes(s.name)),l=a.filter(t=>t.status!=="completed").length,r=a.filter(t=>t.status==="completed").length,n=a.length,D=n>0?r/n*100:0,ge=a.filter(t=>t.status!=="completed").reduce((t,y)=>t+(y.estimatedMinutes||0),0),fe=a.filter(t=>t.status==="completed"&&t.estimatedMinutes&&t.timeSpent).reduce((t,y)=>{const ve=y.estimatedMinutes||1,be=y.timeSpent||1;return t+Math.min(ve/be,2)},0)/Math.max(r,1)*100,Ne=oe.filter(t=>t.assignedTeamMembers&&t.assignedTeamMembers.includes(s.name)).length;return{activeTasks:l,completedTasks:r,totalTasks:n,completionRate:D,totalWorkload:Math.round(ge/60),efficiency:Math.round(fe),assignedClients:Ne,skills:s.skills||[],incapacidades:s.incapacidades||[],oneOnOneSessions:s.oneOnOneSessions||[]}},L=s=>{const a=N(s);let l,r;const n=(a.completionRate+a.efficiency)/2;return n>=85?(l="excellent",r="text-green-600"):n>=70?(l="good",r="text-blue-600"):n>=50?(l="average",r="text-yellow-600"):(l="needs_improvement",r="text-red-600"),{performanceLevel:l,color:r,score:Math.round(n)}},I=s=>s>40?{status:"overloaded",color:"bg-red-500"}:s>30?{status:"high",color:"bg-yellow-500"}:s>15?{status:"moderate",color:"bg-blue-500"}:{status:"light",color:"bg-green-500"},xe=({member:s})=>{const a=N(s),l=L(s),r=I(a.totalWorkload);return e.jsxs(x,{className:"hover:shadow-lg transition-shadow duration-200",children:[e.jsx(Se,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(B,{name:s.name,size:"lg"}),e.jsxs("div",{children:[e.jsx(ke,{className:"text-lg",children:s.name}),e.jsxs(Le,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),s.role]})]})]}),e.jsxs(Y,{children:[e.jsx(H,{asChild:!0,children:e.jsx(o,{variant:"ghost",size:"sm",children:e.jsx(J,{className:"h-4 w-4"})})}),e.jsxs(X,{align:"end",children:[e.jsx(Ie,{children:"Actions"}),e.jsx(i,{asChild:!0,children:e.jsxs(O,{href:`/team-member/${s.id}`,children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"View Profile"]})}),e.jsxs(i,{children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Edit Member"]}),e.jsxs(i,{children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Send Message"]}),e.jsxs(i,{children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Schedule 1:1"]}),e.jsx(Z,{}),e.jsxs(i,{className:"text-red-600",onClick:()=>W.mutate(s.id),children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Remove Member"]})]})]})]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${l.performanceLevel==="excellent"?"bg-green-500":l.performanceLevel==="good"?"bg-blue-500":l.performanceLevel==="average"?"bg-yellow-500":"bg-red-500"}`}),e.jsx("span",{className:`text-sm font-medium ${l.color}`,children:l.performanceLevel.replace("_"," ").charAt(0).toUpperCase()+l.performanceLevel.replace("_"," ").slice(1)})]}),e.jsxs(M,{variant:"outline",className:"text-xs",children:["Score: ",l.score,"%"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Task Completion"}),e.jsxs("span",{className:"font-medium",children:[Math.round(a.completionRate),"%"]})]}),e.jsx(_,{value:a.completionRate,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Workload (",a.totalWorkload,"h)"]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full text-white ${r.color}`,children:r.status})]}),e.jsx(_,{value:Math.min(a.totalWorkload/40*100,100),className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-muted-foreground",children:"Active Tasks:"}),e.jsx("span",{className:"font-medium",children:a.activeTasks})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-muted-foreground",children:"Clients:"}),e.jsx("span",{className:"font-medium",children:a.assignedClients})]})]}),a.skills.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Skills"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.skills.slice(0,3).map((n,D)=>e.jsx(M,{variant:"secondary",className:"text-xs",children:n},D)),a.skills.length>3&&e.jsxs(M,{variant:"outline",className:"text-xs",children:["+",a.skills.length-3," more"]})]})]}),e.jsx(De,{}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-3 w-3"}),s.email]}),s.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(te,{className:"h-3 w-3"}),s.location]})]})]})]})},he=({member:s})=>{const a=N(s),l=L(s),r=I(a.totalWorkload);return e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(B,{name:s.name,size:"md"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),e.jsx(M,{variant:"outline",className:l.color,children:l.performanceLevel.replace("_"," ")}),e.jsx("div",{className:`h-2 w-2 rounded-full ${r.color}`,title:`Workload: ${r.status}`})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ae,{className:"h-3 w-3"}),s.role]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-3 w-3"}),s.email]}),s.location&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(te,{className:"h-3 w-3"}),s.location]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a.activeTasks}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Active Tasks"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.assignedClients}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Clients"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[a.totalWorkload,"h"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Workload"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[l.score,"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Performance"})]}),e.jsxs(Y,{children:[e.jsx(H,{asChild:!0,children:e.jsx(o,{variant:"ghost",size:"sm",children:e.jsx(J,{className:"h-4 w-4"})})}),e.jsxs(X,{align:"end",children:[e.jsx(i,{asChild:!0,children:e.jsxs(O,{href:`/team-member/${s.id}`,children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"View Profile"]})}),e.jsxs(i,{children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Edit Member"]}),e.jsxs(i,{children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Send Message"]}),e.jsxs(i,{children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Schedule 1:1"]}),e.jsx(Z,{}),e.jsxs(i,{className:"text-red-600",onClick:()=>W.mutate(s.id),children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Remove Member"]})]})]})]})]})})};if(ce)return e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,a)=>e.jsx("div",{className:"h-64 bg-gray-200 rounded"},a))})]})});const je=d.reduce((s,a)=>(s.includes(a.role)||s.push(a.role),s),[]),ue=d.length>0?Math.round(d.reduce((s,a)=>s+L(a).score,0)/d.length):0,pe=d.filter(s=>N(s).totalWorkload>40).length;return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Team Members"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your team and track individual performance"})]}),e.jsxs(ze,{open:ie,onOpenChange:T,children:[e.jsx(Ke,{asChild:!0,children:e.jsxs(o,{children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add Team Member"]})}),e.jsxs(_e,{className:"max-w-2xl",children:[e.jsxs(Ge,{children:[e.jsx(Qe,{children:"Add New Team Member"}),e.jsx(Ue,{children:"Create a new team member profile with role and contact information."})]}),e.jsx(Ee,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(me),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{control:c.control,name:"name",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Full Name"}),e.jsx(f,{children:e.jsx(m,{placeholder:"John Smith",...s})})]})}),e.jsx(u,{control:c.control,name:"email",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Email"}),e.jsx(f,{children:e.jsx(m,{type:"email",placeholder:"john@company.com",...s})})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{control:c.control,name:"role",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Role"}),e.jsx(f,{children:e.jsx(m,{placeholder:"Sales Manager",...s})})]})}),e.jsx(u,{control:c.control,name:"position",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Position"}),e.jsx(f,{children:e.jsx(m,{placeholder:"Senior Account Manager",...s,value:s.value||""})})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{control:c.control,name:"location",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Location"}),e.jsx(f,{children:e.jsx(m,{placeholder:"New York, NY",...s,value:s.value||""})})]})}),e.jsx(u,{control:c.control,name:"teamMemberId",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Employee ID"}),e.jsx(f,{children:e.jsx(m,{placeholder:"EMP001",...s,value:s.value||""})})]})})]}),e.jsxs(Be,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsx(o,{type:"submit",disabled:k.isPending,children:k.isPending?"Adding...":"Add Team Member"})]})]})})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(Me,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(m,{placeholder:"Search team members...",value:C,onChange:s=>re(s.target.value),className:"pl-10"})]}),e.jsxs(qe,{value:b,onValueChange:ne,children:[e.jsx(Oe,{className:"w-40",children:e.jsx($e,{placeholder:"Filter by role"})}),e.jsxs(Ve,{children:[e.jsx(ee,{value:"all",children:"All Roles"}),je.map(s=>e.jsx(ee,{value:s.toLowerCase(),children:s},s))]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{variant:w==="grid"?"default":"outline",size:"sm",onClick:()=>P("grid"),children:e.jsx(We,{className:"h-4 w-4"})}),e.jsx(o,{variant:w==="list"?"default":"outline",size:"sm",onClick:()=>P("list"),children:e.jsx(Ye,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsx(x,{children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(E,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:d.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Team Members"})]})]})})}),e.jsx(x,{children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(Ce,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:[ue,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Performance"})]})]})})}),e.jsx(x,{children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(q,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:d.reduce((s,a)=>s+N(a).activeTasks,0)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Tasks"})]})]})})}),e.jsx(x,{children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(Te,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:pe}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Overloaded"})]})]})})})]}),R.length===0?e.jsx(x,{children:e.jsxs(j,{className:"p-12 text-center",children:[e.jsx(E,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No team members found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:C?"Try adjusting your search criteria":"Get started by adding your first team member"}),e.jsxs(o,{children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add Team Member"]})]})}):e.jsx("div",{className:w==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:R.map(s=>w==="grid"?e.jsx(xe,{member:s},s.id):e.jsx(he,{member:s},s.id))})]})}export{hs as default};
