import{t as P,r as t,az as W,h as V,i as H,aA as X,an as Y,j as e,aB as ee,k as te,au as se,B as q,C as b,c as y,g as ae,n as U,f as O,G as re,l as ne,e as le,U as ce,a as F,b as K,ai as ie}from"./index-Dsch-6rs.js";import{S as oe}from"./switch-BeD0BgrE.js";import{C as de}from"./chart-pie-fpzK5xeo.js";import"./index-CJCVC222.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=P("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=P("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=P("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);function $(r={}){const{url:m=`ws://${window.location.host}/api/ws`,reconnectInterval:o=3e3,maxReconnectAttempts:h=5,onMessage:n,onConnected:x,onDisconnected:l,onError:f}=r,s=t.useRef(null),a=t.useRef(0),i=t.useRef(),[k,S]=t.useState(!1),[C,c]=t.useState("disconnected"),d=t.useCallback(()=>{try{c("connecting"),s.current=new WebSocket(m),s.current.onopen=()=>{S(!0),c("connected"),a.current=0,x==null||x()},s.current.onmessage=p=>{try{const j=JSON.parse(p.data);switch(j.type){case"task_update":W.invalidateQueries({queryKey:["/api/tasks"]});break;case"client_update":W.invalidateQueries({queryKey:["/api/clients"]});break;case"team_update":W.invalidateQueries({queryKey:["/api/team-members"]});break}n==null||n(j)}catch(j){console.error("Failed to parse WebSocket message:",j)}},s.current.onclose=()=>{S(!1),c("disconnected"),l==null||l(),a.current<h&&(a.current++,i.current=setTimeout(d,o))},s.current.onerror=p=>{c("error"),f==null||f(p)}}catch(p){c("error"),console.error("WebSocket connection failed:",p)}},[m,o,h,n,x,l,f]),v=t.useCallback(()=>{var p;i.current&&clearTimeout(i.current),(p=s.current)==null||p.close(),S(!1),c("disconnected")},[]),R=t.useCallback(p=>{var j;return((j=s.current)==null?void 0:j.readyState)===WebSocket.OPEN?(s.current.send(JSON.stringify({...p,timestamp:Date.now()})),!0):!1},[]);return t.useEffect(()=>(d(),v),[d,v]),{isConnected:k,connectionState:C,sendMessage:R,connect:d,disconnect:v}}function ue(){const[r,m]=t.useState([]),o=t.useCallback(s=>{s.type==="notification"&&m(a=>[s,...a.slice(0,49)])},[]),{isConnected:h,connectionState:n,sendMessage:x}=$({onMessage:o}),l=t.useCallback(()=>{m([])},[]),f=t.useCallback(s=>{m(a=>a.map(i=>i.timestamp===s?{...i,data:{...i.data,read:!0}}:i))},[]);return{notifications:r,isConnected:h,connectionState:n,clearNotifications:l,markAsRead:f,sendMessage:x}}function he(){const r=V(),m=t.useCallback(async n=>{const x=n.map(l=>r.prefetchQuery({queryKey:[l],staleTime:3e5,gcTime:6e5}));await Promise.allSettled(x)},[r]),o=t.useCallback(n=>{n.forEach(x=>{r.invalidateQueries({queryKey:[x],exact:!1})})},[r]),h=t.useCallback(()=>{r.clear()},[r]);return{prefetchData:m,invalidateMultiple:o,clearCache:h}}function pe(){const[r,m]=t.useState({renderTime:0,apiCallCount:0,cacheHitRate:0}),o=t.useRef(),h=t.useRef(0),n=t.useRef(0),x=t.useCallback(()=>{o.current=performance.now()},[]),l=t.useCallback(()=>{if(o.current){const a=performance.now()-o.current;m(i=>({...i,renderTime:a}))}},[]),f=t.useCallback((a=!1)=>{h.current++,a&&n.current++;const i=h.current>0?n.current/h.current*100:0;m(k=>({...k,apiCallCount:h.current,cacheHitRate:i}))},[]),s=t.useCallback(()=>{if("memory"in performance){const a=performance.memory;return{usedJSHeapSize:a.usedJSHeapSize,totalJSHeapSize:a.totalJSHeapSize,usedPercentage:a.usedJSHeapSize/a.totalJSHeapSize*100}}return null},[]);return t.useEffect(()=>{const a=setInterval(()=>{const i=s();i&&m(k=>({...k,memoryUsage:i.usedPercentage}))},5e3);return()=>clearInterval(a)},[s]),{metrics:r,startRenderTimer:x,endRenderTimer:l,trackApiCall:f,getMemoryUsage:s}}function be(){var E;const[r,m]=t.useState(!0),[o,h]=t.useState(3e4),{data:n=[],isLoading:x}=H({queryKey:["/api/clients"],refetchInterval:r?o:!1,staleTime:1e4}),{data:l=[],isLoading:f}=H({queryKey:["/api/tasks"],refetchInterval:r?o:!1,staleTime:1e4}),{data:s=[],isLoading:a}=H({queryKey:["/api/team-members"],refetchInterval:r?o:!1,staleTime:1e4});H({queryKey:["/api/statistics"],refetchInterval:r?o:!1,staleTime:1e4});const{isConnected:i,connectionState:k,sendMessage:S}=$({onMessage:u=>{console.log("Real-time update received:",u),c.showInfo("Real-time Update",`${u.type.replace("_"," ")} data refreshed`,{duration:3e3})},onConnected:()=>{c.showSuccess("Connected","Real-time updates enabled",{duration:3e3})},onDisconnected:()=>{c.showWarning("Disconnected","Real-time updates paused",{duration:5e3})}}),{notifications:C}=ue(),c=X(),{metrics:d,startRenderTimer:v,endRenderTimer:R,trackApiCall:p}=pe(),{prefetchData:j,invalidateMultiple:B}=he();t.useEffect(()=>(v(),()=>R()),[v,R]);const w=Y.useMemo(()=>{const u=n.reduce((g,N)=>{var A;return g+(((A=N.kpis)==null?void 0:A.reduce((z,J)=>z+(typeof J.actual=="number"?J.actual:0),0))||0)},0),I=l.filter(g=>g.status==="completed").length,T=l.length>0?I/l.length*100:0,M=l.filter(g=>g.priority==="high"||g.priority==="critical").length,L=n.map(g=>{const N=g.kpis||[],A=N.filter(z=>z.met).length;return N.length>0?A/N.length*100:100}),Z=L.length>0?L.reduce((g,N)=>g+N,0)/L.length:100;return{totalRevenue:u,completionRate:T,urgentTasks:M,avgClientHealth:Z,activeClients:n.length,teamSize:s.length,lastUpdated:new Date().toLocaleTimeString()}},[n,l,s]),_=u=>{m(u),u?c.showInfo("Auto-refresh Enabled",`Updates every ${o/1e3} seconds`,{duration:3e3}):c.showInfo("Auto-refresh Disabled","Manual refresh only",{duration:3e3})},G=async()=>{await B(["/api/clients","/api/tasks","/api/team-members","/api/statistics"]),c.showSuccess("Data Refreshed","All data updated successfully",{duration:2e3})};t.useEffect(()=>{d.renderTime>100&&c.showWarning("Performance Alert",`Slow rendering detected: ${d.renderTime.toFixed(1)}ms`,{duration:5e3}),d.memoryUsage&&d.memoryUsage>80&&c.showWarning("Memory Usage High",`${d.memoryUsage.toFixed(1)}% memory used`,{duration:7e3})},[d,c]);const D=x||f||a;return e.jsxs("div",{className:"flex-1 overflow-y-auto p-8 bg-gradient-to-br from-slate-50 to-blue-50 dark:from-gray-900 dark:to-blue-900",children:[e.jsx(ee,{notifications:c.notifications,onDismiss:c.dismissNotification}),e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"Real-Time Analytics"}),e.jsx("p",{className:"text-slate-600 dark:text-gray-300 mt-1",children:"Live business intelligence and performance monitoring"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:i?e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Live"}),e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"})]}):e.jsxs("div",{className:"flex items-center gap-2 text-red-600",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Offline"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Auto-refresh"}),e.jsx(oe,{checked:r,onCheckedChange:_})]}),e.jsxs(te,{variant:"outline",size:"sm",onClick:G,disabled:D,children:[e.jsx(se,{className:`h-4 w-4 mr-2 ${D?"animate-spin":""}`}),"Refresh"]}),e.jsx(q,{variant:"secondary",className:"font-mono",children:w.lastUpdated})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(b,{className:"border-0 shadow-lg bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 dark:text-blue-300",children:"Live Revenue"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-900 dark:text-blue-100",children:["$",w.totalRevenue.toLocaleString()]}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(ae,{className:"h-4 w-4 text-green-600 mr-1"}),e.jsx("span",{className:"text-sm text-green-600 font-medium",children:"Real-time"})]})]}),e.jsx("div",{className:"p-3 bg-blue-200 dark:bg-blue-700 rounded-full",children:e.jsx(U,{className:"h-8 w-8 text-blue-700 dark:text-blue-200"})})]})})}),e.jsx(b,{className:"border-0 shadow-lg bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900 dark:to-green-800",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600 dark:text-green-300",children:"Task Completion"}),e.jsxs("p",{className:"text-3xl font-bold text-green-900 dark:text-green-100",children:[w.completionRate.toFixed(1),"%"]}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(O,{className:"h-4 w-4 text-green-600 mr-1"}),e.jsxs("span",{className:"text-sm text-green-600 font-medium",children:[l.filter(u=>u.status==="completed").length," of ",l.length]})]})]}),e.jsx("div",{className:"p-3 bg-green-200 dark:bg-green-700 rounded-full",children:e.jsx(re,{className:"h-8 w-8 text-green-700 dark:text-green-200"})})]})})}),e.jsx(b,{className:"border-0 shadow-lg bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900 dark:to-orange-800",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600 dark:text-orange-300",children:"Urgent Tasks"}),e.jsx("p",{className:"text-3xl font-bold text-orange-900 dark:text-orange-100",children:w.urgentTasks}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(ne,{className:"h-4 w-4 text-orange-600 mr-1"}),e.jsx("span",{className:"text-sm text-orange-600 font-medium",children:"Needs attention"})]})]}),e.jsx("div",{className:"p-3 bg-orange-200 dark:bg-orange-700 rounded-full",children:e.jsx(le,{className:"h-8 w-8 text-orange-700 dark:text-orange-200"})})]})})}),e.jsx(b,{className:"border-0 shadow-lg bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900 dark:to-purple-800",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-600 dark:text-purple-300",children:"Client Health"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-900 dark:text-purple-100",children:[w.avgClientHealth.toFixed(1),"%"]}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(ce,{className:"h-4 w-4 text-purple-600 mr-1"}),e.jsxs("span",{className:"text-sm text-purple-600 font-medium",children:[w.activeClients," clients"]})]})]}),e.jsx("div",{className:"p-3 bg-purple-200 dark:bg-purple-700 rounded-full",children:e.jsx(de,{className:"h-8 w-8 text-purple-700 dark:text-purple-200"})})]})})})]}),e.jsxs(b,{className:"border-0 shadow-lg",children:[e.jsx(F,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),"Performance Monitor"]})}),e.jsx(y,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(ie,{className:"h-8 w-8 text-yellow-600 mx-auto mb-2"}),e.jsx("p",{className:"font-semibold",children:"Render Time"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-600",children:[d.renderTime.toFixed(1),"ms"]})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(U,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"font-semibold",children:"API Calls"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:d.apiCallCount})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(O,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"font-semibold",children:"Cache Hit Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[d.cacheHitRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Q,{className:"h-8 w-8 text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"font-semibold",children:"Memory Usage"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[((E=d.memoryUsage)==null?void 0:E.toFixed(1))||"N/A","%"]})]})]})})]}),e.jsxs(b,{children:[e.jsx(F,{children:e.jsx(K,{children:"Advanced Analytics"})}),e.jsx(y,{children:e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Advanced charts available after WebSocket connection is established"})})]}),e.jsxs(b,{className:"border-0 shadow-lg",children:[e.jsx(F,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),"Live Activity Feed",e.jsxs(q,{variant:"secondary",className:"ml-2",children:[C.length," updates"]})]})}),e.jsx(y,{className:"max-h-96 overflow-y-auto",children:C.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(U,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No real-time updates yet"}),e.jsx("p",{className:"text-sm",children:"Updates will appear here when data changes"})]}):e.jsx("div",{className:"space-y-3",children:C.slice(0,10).map((u,I)=>{var T,M;return e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:((T=u.data)==null?void 0:T.title)||u.type}),e.jsx("p",{className:"text-sm text-gray-600",children:(M=u.data)==null?void 0:M.message})]}),e.jsx(q,{variant:"outline",className:"font-mono text-xs",children:new Date(u.timestamp).toLocaleTimeString()})]},I)})})})]})]})]})}export{be as default};
