import{t as Z,v as _,r as ee,h as se,u as ae,i as f,j as e,C as l,c,l as te,k as t,L as M,p as le,B as v,n as H,f as ce,U as k,D as ie,w as ne,x as re,y as j,z as u,a as y,b as w,q as K,F as z,G as de,H as N,J as me,P as q,M as xe,E as I,o as oe,s as he}from"./index-Dsch-6rs.js";import{u as je}from"./useMutation-CWIftKBJ.js";import{C as D}from"./character-avatar-CLvC-lt9.js";import{B as ue,P as Ne}from"./phone-JggXFZjv.js";import{S as pe}from"./square-pen-BNtb5a4z.js";import{f as b}from"./format-BEMO4FpZ.js";import{P as n}from"./plus-CRp7_VfK.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=Z("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function Ae(){var S,P;const[,C]=_("/clients/:id"),m=parseInt((C==null?void 0:C.id)||"0"),[R,E]=ee.useState("overview"),L=se(),{toast:F}=ae(),{data:a,isLoading:Q}=f({queryKey:["/api/clients",m],enabled:!!m}),{data:x=[]}=f({queryKey:["/api/client-activities",m],enabled:!!m}),{data:$=[]}=f({queryKey:["/api/tasks"]}),{data:G=[]}=f({queryKey:["/api/team-members"]}),d=$.filter(s=>s.assignedTo&&s.assignedTo.includes((a==null?void 0:a.name)||"")),p=G.filter(s=>{var i;return(i=a==null?void 0:a.assignedTeamMembers)==null?void 0:i.includes(s.name)}),O=()=>{if(!a)return{status:"unknown",score:0,color:"text-gray-500"};const s=d.filter(T=>T.status==="completed").length,i=d.length,W=i>0?s/i*100:0,A=a.kpis||[],X=A.filter(T=>T.met).length,Y=A.length>0?X/A.length*100:100,g=(W+Y)/2;let o,h;return g>=80?(o="Excellent",h="text-green-600"):g>=60?(o="Good",h="text-blue-600"):g>=40?(o="Needs Attention",h="text-yellow-600"):(o="Critical",h="text-red-600"),{status:o,score:Math.round(g),color:h}};if(je({mutationFn:async s=>(await he("POST","/api/client-activities",{clientId:m,...s,createdAt:new Date().toISOString()})).json(),onSuccess:()=>{L.invalidateQueries({queryKey:["/api/client-activities",m]}),F({title:"Activity added",description:"Client activity has been successfully recorded."})}}),Q)return e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})});if(!a)return e.jsx("div",{className:"p-6",children:e.jsx(l,{children:e.jsxs(c,{className:"p-12 text-center",children:[e.jsx(te,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Client not found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The requested client could not be found."}),e.jsx(t,{asChild:!0,children:e.jsxs(M,{href:"/clients",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Back to Clients"]})})]})})});const r=O(),V=d.filter(s=>s.status!=="completed").length,U=d.filter(s=>s.status==="completed").length,J=((S=a.kpis)==null?void 0:S.reduce((s,i)=>s+(i.actual||0),0))||0;return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(t,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs(M,{href:"/clients",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Back to Clients"]})}),e.jsx(le,{orientation:"vertical",className:"h-6"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{name:a.name,size:"lg"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:a.name}),e.jsxs("p",{className:"text-muted-foreground flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),a.company]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(v,{variant:"outline",className:r.color,children:[r.status," â€¢ ",r.score,"%"]}),e.jsxs(t,{children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Edit Client"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(l,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(H,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:V}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Tasks"})]})]})})}),e.jsx(l,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(ce,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:U}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed"})]})]})})}),e.jsx(l,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(k,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:p.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Team Members"})]})]})})}),e.jsx(l,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:e.jsx(ie,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:["$",J.toLocaleString()]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Value"})]})]})})})]}),e.jsxs(ne,{value:R,onValueChange:E,children:[e.jsxs(re,{className:"grid w-full grid-cols-5",children:[e.jsx(j,{value:"overview",children:"Overview"}),e.jsxs(j,{value:"tasks",children:["Tasks (",d.length,")"]}),e.jsxs(j,{value:"team",children:["Team (",p.length,")"]}),e.jsxs(j,{value:"kpis",children:["KPIs (",((P=a.kpis)==null?void 0:P.length)||0,")"]}),e.jsxs(j,{value:"activities",children:["Activities (",x.length,")"]})]}),e.jsx(u,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(l,{children:[e.jsx(y,{children:e.jsx(w,{children:"Client Information"})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(K,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Email:"}),e.jsx("span",{className:"font-medium",children:a.email})]}),a.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ne,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Phone:"}),e.jsx("span",{className:"font-medium",children:a.phone})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(z,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Since:"}),e.jsx("span",{className:"font-medium",children:a.createdAt?b(new Date(a.createdAt),"MMM dd, yyyy"):"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(de,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Health Score:"}),e.jsxs("span",{className:`font-medium ${r.color}`,children:[r.score,"%"]})]})]})]}),a.notes&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Notes:"}),e.jsx("p",{className:"text-sm bg-muted p-3 rounded-lg",children:a.notes})]})]})]}),e.jsxs(l,{children:[e.jsx(y,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{children:"Recent Activities"}),e.jsxs(t,{size:"sm",variant:"outline",children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Add Activity"]})]})}),e.jsx(c,{children:x.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(N,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("p",{children:"No activities recorded yet"})]}):e.jsxs("div",{className:"space-y-4",children:[x.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(N,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium capitalize",children:s.type}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.createdAt?b(new Date(s.createdAt),"MMM dd, HH:mm"):""})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.content})]})]},s.id)),x.length>5&&e.jsxs(t,{variant:"ghost",size:"sm",className:"w-full",children:["View All Activities",e.jsx(me,{className:"h-4 w-4 ml-2"})]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(l,{children:[e.jsx(y,{children:e.jsx(w,{children:"Client Health Score"})}),e.jsx(c,{children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"text-4xl font-bold",children:[r.score,"%"]}),e.jsx("div",{className:`text-sm ${r.color}`,children:r.status})]}),e.jsx(q,{value:r.score,className:"h-3"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Based on task completion and KPI performance"})]})})]}),e.jsxs(l,{children:[e.jsx(y,{children:e.jsx(w,{children:"Quick Actions"})}),e.jsxs(c,{className:"space-y-2",children:[e.jsxs(t,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Send Message"]}),e.jsxs(t,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Schedule Meeting"]}),e.jsxs(t,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Generate Report"]}),e.jsxs(t,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Create Task"]})]})]})]})]})}),e.jsxs(u,{value:"tasks",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Client Tasks"}),e.jsxs(t,{size:"sm",children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Add Task"]})]}),d.length===0?e.jsx(l,{children:e.jsxs(c,{className:"p-12 text-center",children:[e.jsx(H,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No tasks found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No tasks have been assigned to this client yet."}),e.jsxs(t,{children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Create First Task"]})]})}):e.jsx("div",{className:"space-y-4",children:d.map(s=>e.jsx(l,{children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx(v,{variant:s.status==="completed"?"default":"secondary",children:s.status}),e.jsx(v,{variant:"outline",children:s.priority})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[s.dueDate&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"h-3 w-3"}),"Due: ",b(new Date(s.dueDate),"MMM dd")]}),s.assignedTo&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"h-3 w-3"}),s.assignedTo]})]})]}),e.jsx(t,{variant:"ghost",size:"sm",children:e.jsx(I,{className:"h-4 w-4"})})]})})},s.id))})]}),e.jsxs(u,{value:"team",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Assigned Team Members"}),e.jsxs(t,{size:"sm",children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Assign Member"]})]}),p.length===0?e.jsx(l,{children:e.jsxs(c,{className:"p-12 text-center",children:[e.jsx(k,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No team members assigned"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Assign team members to work on this client."}),e.jsxs(t,{children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Assign Team Member"]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map(s=>e.jsx(l,{children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{name:s.name,size:"md"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.role}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(K,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.email})]})]}),e.jsx(t,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(M,{href:`/team/${s.id}`,children:e.jsx(I,{className:"h-4 w-4"})})})]})})},s.id))})]}),e.jsxs(u,{value:"kpis",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Key Performance Indicators"}),e.jsxs(t,{size:"sm",children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Add KPI"]})]}),!a.kpis||a.kpis.length===0?e.jsx(l,{children:e.jsxs(c,{className:"p-12 text-center",children:[e.jsx(oe,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No KPIs defined"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Set up key performance indicators to track client success."}),e.jsxs(t,{children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Create First KPI"]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.kpis.map((s,i)=>e.jsx(l,{children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx(v,{variant:s.met?"default":"secondary",children:s.met?"Met":"Not Met"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progress"}),e.jsxs("span",{className:"font-medium",children:[s.actual," / ",s.target]})]}),e.jsx(q,{value:Math.min(s.actual/s.target*100,100),className:"h-2"})]})]})})},i))})]}),e.jsxs(u,{value:"activities",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"All Activities"}),e.jsxs(t,{size:"sm",children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Add Activity"]})]}),x.length===0?e.jsx(l,{children:e.jsxs(c,{className:"p-12 text-center",children:[e.jsx(N,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No activities recorded"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Start tracking client interactions and milestones."}),e.jsxs(t,{children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"Record First Activity"]})]})}):e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsx(l,{children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(N,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium capitalize",children:s.type}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.createdAt?b(new Date(s.createdAt),"MMM dd, yyyy HH:mm"):""})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.content})]})]})})},s.id))})]})]})]})}export{Ae as default};
